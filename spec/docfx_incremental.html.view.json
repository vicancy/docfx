{"_lang":"csharp","_tocPath":"spec/toc.html","_navPath":"toc.html","_rel":"../","_path":"spec/docfx_incremental.html","_navRel":"../toc.html","_tocRel":"toc.html","_navKey":"~/../toc.yml","_tocKey":"~/../spec/toc.md","conceptual":"\n<p sourcefile=\"../spec/docfx_incremental.md\" sourcestartlinenumber=\"4\" sourceendlinenumber=\"4\">This documentation describes the implementation of incrementally extracting metadata from source. Currently we are using <em>Roslyn</em> to compile and analyse source code on the fly. When input sources are large, it may take minutes to load and process the files. To speed up the extraction, previous extracted details are saved to cache for further reference. </p>\n<p sourcefile=\"../spec/docfx_incremental.md\" sourcestartlinenumber=\"6\" sourceendlinenumber=\"6\">There are two level caches in current implementation. First one is called <em>Application</em> Level cache, and the other one is <em>Project</em> level cache.</p>\n<p sourcefile=\"../spec/docfx_incremental.md\" sourcestartlinenumber=\"8\" sourceendlinenumber=\"8\"><em>Application</em> level cache is saved in file <code>%LocalAppData%/xdoc/cache</code>.</p>\n<p sourcefile=\"../spec/docfx_incremental.md\" sourcestartlinenumber=\"10\" sourceendlinenumber=\"10\">For <em>Project</em> level cache,</p>\n<p sourcefile=\"../spec/docfx_incremental.md\" sourcestartlinenumber=\"12\" sourceendlinenumber=\"12\">a. If input sources are supported project files, e.g. <code>.csproj</code> or <code>.vbproj</code> files, <em>Project</em> level cache is located in file <code>obj/xdoc/.cache</code> under the same folder of the project file. </p>\n<p sourcefile=\"../spec/docfx_incremental.md\" sourcestartlinenumber=\"14\" sourceendlinenumber=\"14\">b. If input sources are supported source code files, e.g. <code>.cs</code> or <code>.vb</code> files, <em>Project</em> level cache is located in file <code>obj/xdoc/.cache</code> under the same folder of the alphabetically first source code file.</p>\n<p sourcefile=\"../spec/docfx_incremental.md\" sourcestartlinenumber=\"16\" sourceendlinenumber=\"16\">The cache file contains key-value pairs saved in <em>JSON</em> format. The key is the normalized input source code files, and the data structure for the value is as below:</p>\n<table sourcefile=\"../spec/docfx_incremental.md\" sourcestartlinenumber=\"18\" sourceendlinenumber=\"24\">\n<thead>\n<tr>\n<th>Property</th>\n<th>Description</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>TriggeredUTCTime</td>\n<td>The UTC time when the action is triggered</td>\n</tr>\n<tr>\n<td>CompletedUTCTime</td>\n<td>The UTC time when the action is completed</td>\n</tr>\n<tr>\n<td>OutputFolder</td>\n<td>The output folder for the extracted result</td>\n</tr>\n<tr>\n<td>RelativeOutputFiles</td>\n<td>The paths of the extracted results related to the <em>OutputFolder</em></td>\n</tr>\n<tr>\n<td>CheckSum</td>\n<td>The MD5 checksum calculated for all the extracted results</td>\n</tr>\n</tbody>\n</table>\n<p sourcefile=\"../spec/docfx_incremental.md\" sourcestartlinenumber=\"26\" sourceendlinenumber=\"26\">Detailed Steps are described below: </p>\n<ol sourcefile=\"../spec/docfx_incremental.md\" sourcestartlinenumber=\"27\" sourceendlinenumber=\"47\">\n<li sourcefile=\"../spec/docfx_incremental.md\" sourcestartlinenumber=\"27\" sourceendlinenumber=\"30\">For each input solution/project/source files, get most latest <code>LastModifiedTime</code>.\n a. For solution, get <code>LastModifiedTime</code> for the solution file, and containing projects\n b. For project, get <code>LastModifiedTime</code> for the project file, project references, assembly references and containing documents.\n c. For source files, get <code>LastModifiedTime</code> for the files</li>\n<li sourcefile=\"../spec/docfx_incremental.md\" sourcestartlinenumber=\"31\" sourceendlinenumber=\"31\"><p sourcefile=\"../spec/docfx_incremental.md\" sourcestartlinenumber=\"31\" sourceendlinenumber=\"31\">Normalize project list, check if <em>Application</em> level cache for these project list exists. Compare <code>TriggeredUTCTime</code> with the <code>LastModifiedTime</code> fetched in #1, and check if checksum remains unchanged for output files. If is, copy result files to output folder. Otherwise, continue to #3.</p>\n</li>\n<li sourcefile=\"../spec/docfx_incremental.md\" sourcestartlinenumber=\"33\" sourceendlinenumber=\"39\"><p sourcefile=\"../spec/docfx_incremental.md\" sourcestartlinenumber=\"33\" sourceendlinenumber=\"33\">For each supported solution/project/source code files,</p>\n<p sourcefile=\"../spec/docfx_incremental.md\" sourcestartlinenumber=\"35\" sourceendlinenumber=\"35\"> <em>Step 1</em>. Check if <em>Project</em> level cache exists. If not, go to <em>Step 4</em>.</p>\n<p sourcefile=\"../spec/docfx_incremental.md\" sourcestartlinenumber=\"37\" sourceendlinenumber=\"37\"> <em>Step 2</em>. Compare <code>TriggeredUTCTime</code> with the <code>LastModifiedTime</code> fetched in #1, and check if checksum remains unchanged for output files. If not, go to <em>Step 3</em>.</p>\n<p sourcefile=\"../spec/docfx_incremental.md\" sourcestartlinenumber=\"39\" sourceendlinenumber=\"39\"> <em>Step 3</em>. Generate YAML metadata for current project and save to <em>Project</em> level cache.</p>\n</li>\n<li sourcefile=\"../spec/docfx_incremental.md\" sourcestartlinenumber=\"41\" sourceendlinenumber=\"45\"><p sourcefile=\"../spec/docfx_incremental.md\" sourcestartlinenumber=\"41\" sourceendlinenumber=\"41\">Read YAML metadata for each project, and merge with others following rules below:</p>\n<p sourcefile=\"../spec/docfx_incremental.md\" sourcestartlinenumber=\"43\" sourceendlinenumber=\"43\"> <em>Rule 1</em>. For <code>namespace</code>, if <code>uid</code> equals, <strong>append</strong>.</p>\n<p sourcefile=\"../spec/docfx_incremental.md\" sourcestartlinenumber=\"45\" sourceendlinenumber=\"45\"> <em>Rule 2</em>. For other type, if <code>uid</code> equals, <strong>override</strong>.</p>\n</li>\n<li sourcefile=\"../spec/docfx_incremental.md\" sourcestartlinenumber=\"47\" sourceendlinenumber=\"47\"><p sourcefile=\"../spec/docfx_incremental.md\" sourcestartlinenumber=\"47\" sourceendlinenumber=\"47\">Save result, and update <em>*Application</em> level cache.</p>\n</li>\n</ol>\n","type":"Conceptual","source":{"remote":{"path":"Documentation/spec/docfx_incremental.md","branch":"doc","repo":"https://github.com/dotnet/docfx.git"},"startLine":0.0,"endLine":0.0,"isExternal":false},"path":"../spec/docfx_incremental.md","documentation":{"remote":{"path":"Documentation/spec/docfx_incremental.md","branch":"doc","repo":"https://github.com/dotnet/docfx.git"},"startLine":0.0,"endLine":0.0,"isExternal":false},"_docfxVersion":"2.15.0.424","_systemKeys":["conceptual","type","source","path","documentation","title","rawTitle","wordCount"],"title":"Doc-as-code: DocFx.exe Incremental Build Specification","rawTitle":"<h1 id=\"doc-as-code-docfxexe-incremental-build-specification\" sourcefile=\"../spec/docfx_incremental.md\" sourcestartlinenumber=\"1\" sourceendlinenumber=\"2\">Doc-as-code: DocFx.exe Incremental Build Specification</h1>","wordCount":419.0,"__global":{"classesInSubtitle":"Classes","structsInSubtitle":"Structs","interfacesInSubtitle":"Interfaces","enumsInSubtitle":"Enums","delegatesInSubtitle":"Delegates","constructorsInSubtitle":"Constructors","fieldsInSubtitle":"Fields","propertiesInSubtitle":"Properties","methodsInSubtitle":"Methods","eventsInSubtitle":"Events","operatorsInSubtitle":"Operators","eiisInSubtitle":"Explicit Interface Implementations","improveThisDoc":"Improve this Doc","viewSource":"View Source","inheritance":"Inheritance","inheritedMembers":"Inherited Members","namespace":"Namespace","assembly":"Assembly","syntax":"Syntax","overrides":"Overrides","implements":"Implements","remarks":"Remarks","examples":"Examples","seealso":"See Also","declaration":"Declaration","parameters":"Parameters","typeParameters":"Type Parameters","type":"Type","name":"Name","description":"Description","returns":"Returns","fieldValue":"Field Value","propertyValue":"Property Value","eventType":"Event Type","exceptions":"Exceptions","condition":"Condition","extensionMethods":"Extension Methods","note":"<h5>Note</h5>","warning":"<h5>Warning</h5>","tip":"<h5>Tip</h5>","important":"<h5>Important</h5>","caution":"<h5>Caution</h5>","_shared":{}},"_disableToc":false,"docurl":"https://github.com/dotnet/docfx/blob/doc/Documentation/spec/docfx_incremental.md/#L1"}